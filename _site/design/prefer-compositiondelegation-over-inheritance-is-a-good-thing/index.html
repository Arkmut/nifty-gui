<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Prefer composition&#47;delegation over inheritance is a good thing! &#8211; Nifty GUI</title>
<meta name="description" content="I am refactoring Nifty-GUI's internal workings. Trying to make it less inheritance dependent.

To manage all the Elements (Panels, Images, Text and so on) I have quickly and with not much thought introduced a Element class hierarchy as shown in figure 1.



figure 1: reasonable (?) class hierachie 

Well, each Element has an "void abstract render()" method to render itself. This method is overwritten in the subclasses. This is reasonable because the steps you'll need to render an Image are probably different to f.i. a TextElement. You have seen this kind of solution a million times before. So why should this be a bad thing?

">
<meta name="keywords" content="">

  

<!-- Twitter Cards -->
<meta name="twitter:title" content="Prefer composition&#47;delegation over inheritance is a good thing!">
<meta name="twitter:description" content="I am refactoring Nifty-GUI's internal workings. Trying to make it less inheritance dependent.

To manage all the Elements (Panels, Images, Text and so on) I have quickly and with not much thought introduced a Element class hierarchy as shown in figure 1.



figure 1: reasonable (?) class hierachie 

Well, each Element has an "void abstract render()" method to render itself. This method is overwritten in the subclasses. This is reasonable because the steps you'll need to render an Image are probably different to f.i. a TextElement. You have seen this kind of solution a million times before. So why should this be a bad thing?

">
<meta name="twitter:site" content="@void256">


<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/default-thumb.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Prefer composition&#47;delegation over inheritance is a good thing!">
<meta property="og:description" content="I am refactoring Nifty-GUI's internal workings. Trying to make it less inheritance dependent.

To manage all the Elements (Panels, Images, Text and so on) I have quickly and with not much thought introduced a Element class hierarchy as shown in figure 1.



figure 1: reasonable (?) class hierachie 

Well, each Element has an "void abstract render()" method to render itself. This method is overwritten in the subclasses. This is reasonable because the steps you'll need to render an Image are probably different to f.i. a TextElement. You have seen this kind of solution a million times before. So why should this be a bad thing?

">
<meta property="og:url" content="/design/prefer-compositiondelegation-over-inheritance-is-a-good-thing/">
<meta property="og:site_name" content="Nifty GUI">





<link rel="canonical" href="/design/prefer-compositiondelegation-over-inheritance-is-a-good-thing/">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Nifty GUI Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
	<script src="/assets/js/vendor/html5shiv.min.js"></script>
	<script src="/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>

<link href='//fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700%7CPT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="post">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="/">Nifty GUI</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" id="site-nav" class="nav">
		    <ul>
		        
				    
				        
				    
				    <li><a href="/about/" >About</a></li>
				
				    
				        
				    
				    <li><a href="/posts/" >Blog</a></li>
				
				    
				        
				        
				    <li><a href="https://github.com/void256/nifty-gui" target="_blank">Nifty GUI @ GitHub</a></li>
				
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main">
  <div class="article-author-side">
    
  


	<img src="/images/" class="bio-photo" alt=" bio photo">

<h3></h3>
<p></p>
















  </div>
  <article class="post">
    <div class="headline-wrap">
      
        <h1><a href="/design/prefer-compositiondelegation-over-inheritance-is-a-good-thing/" rel="bookmark" title="Prefer composition&#47;delegation over inheritance is a good thing!">Prefer composition&#47;delegation over inheritance is a good thing!</a></h1>
      
    </div><!--/ .headline-wrap -->
    <div class="article-wrap">
      <p>I am refactoring Nifty-GUI's internal workings. Trying to make it less inheritance dependent.</p>
<p>To manage all the Elements (Panels, Images, Text and so on) I have quickly and with not much thought introduced a Element class hierarchy as shown in figure 1.</p>
<p>&lt;img src="http:&#47;&#47;nifty-gui.lessvoid.com&#47;images&#47;remove-inheritance-before.png" alt="figure 1: reasonable (?) class hierachie" border="0" height="128" hspace="2" vspace="2" width="141" &#47;&gt;</p>
<p><strong>figure 1: reasonable (?) class hierachie &lt;&#47;strong&gt;
<p>Well, each Element has an "void abstract render()" method to render itself. This method is overwritten in the subclasses. This is reasonable because the steps you'll need to render an Image are probably different to f.i. a TextElement. You have seen this kind of solution a million times before. So why should this be a bad thing?</p>
<p><a id="more"></a><a id="more-6"></a>Alex Miller points in his Blog the drawbacks of the Template Method out (see his very cool entry here: <a href="http:&#47;&#47;tech.puredanger.com&#47;2007&#47;07&#47;03&#47;pattern-hate-template&#47;" title="Alex Miller - Patters I Hate #2: Template Pattern">Alex Miller - Pattern I Hate #2: Template Method&lt;&#47;a&gt;). And although this is not really a Template Pattern in it's purest form it sure has most of the drawbacks as Alex points out, for instance:
<ul>
<li><strong>Difficult to compose functionality:&lt;&#47;strong&gt; Say I want to change more behaviour not only rendering. Maybe layout the element, mouse events, key events and so on. If I'd introduce for every behaviour a new (abstract) method that is supposed to be overwritten in a sub class things get messy and complicated pretty soon.&lt;&#47;li&gt;<br />
&lt;&#47;ul&gt;<br />
I noticed that the only difference my Elements had until now, was the way they rendered themself on the screen. As I am not really a friend of inheritance at all ;) I ask myself: Why not remove the whole Element hierarchy?
<p>And it is easily possible. I can extract the functionality of "rendering an element" into an Interface. I call this an "ElementRenderer" Interface with only one Method: "render":</p>
<pre>public interface ElementRenderer {&lt;&#47;pre&gt;
<pre>  &#47;**&lt;&#47;pre&gt;
<pre>   * render the element.&lt;&#47;pre&gt;
<pre>   * @param w the Element&lt;&#47;pre&gt;
<pre>   * @param r the RenderDevice for output.&lt;&#47;pre&gt;
<pre>   *&#47;&lt;&#47;pre&gt;
<pre>  void render(Element w, RenderDevice r);&lt;&#47;pre&gt;
<pre>}&lt;&#47;pre&gt;<br />
Doing it this way, I can remove the whole Element hierarchy. I am left with a single class, the Element class and I can "inject" different behaviour into this class using different "ElementRenderer" implementations. One way to achieve this is "constructor injection" and simply give the Element constructor an additional parameter, the ElementRenderer this Element should use.
<pre> public Element(final ElementRenderer newElementRenderer) {  ... }&lt;&#47;pre&gt;<br />
So implementing the ElementRenderer is easy and I don't need to care about the whole Element hierachy anymore. Furthermore I noticed that at the moment some elements can share the same ElementRenderer. For instance my MenuItems and Text-Elements really use the same TextRenderer implementation!
<p>You can see in figure 2 the removed hierachy and the new ElementRenderer interface I've come up with as well as the first three implementations.</p>
<p>&lt;img src="http:&#47;&#47;nifty-gui.lessvoid.com&#47;images&#47;remove-inheritance-after.png" alt="figure 2: inject some interface is better" border="0" height="128" hspace="2" vspace="2" width="355" &#47;&gt;</p>
<p><strong>figure 2: inject some interface is better&lt;&#47;strong&gt;
<p>There is one drawback however. All state information that an ElementRenderer needs to render an Element have to be somehow public accessible. In my case that was not much of a problem, because the Element already had a Postition on Screen. All other Information is part of the Renderer. For instance to render an Image the filename of the image is part of the ImageRenderer and not of the Element (because it has something to do with the visual representation of the element, so there's no need to "polute" the Element class with that information).</p>
<p>I'm pretty happy now :)</p>
<p>Reference:</p>
<ul>
<li><a href="http:&#47;&#47;www.javaworld.com&#47;javaworld&#47;jw-08-2003&#47;jw-0801-toolbox.html" title="Why extends is evil">Java World article: Why extends is evil&lt;&#47;a&gt;&lt;&#47;li&gt;
<li><a href="http:&#47;&#47;tech.puredanger.com&#47;2007&#47;07&#47;03&#47;pattern-hate-template&#47;" title="Alex Miller - Patters I Hate #2: Template Pattern">Alex Miller Blog: Pattern I Hate #2: Template Method)&lt;&#47;a&gt;&lt;&#47;li&gt;<br />
&lt;&#47;ul&gt;<br />
<a href="http:&#47;&#47;www.javaworld.com&#47;javaworld&#47;jw-08-2003&#47;jw-0801-toolbox.html" title="Why extends is evil"><br />
&lt;&#47;a&gt;
</a></a></li></a></li></ul></strong></p></pre></pre></pre></pre></pre></pre></pre></pre></pre></strong></li></ul></a></p></strong></p>

      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          
  


	<img src="/images/" class="bio-photo" alt=" bio photo">

<h3></h3>
<p></p>
















        </div>
        <p class="byline"><strong>Prefer composition&#47;delegation over inheritance is a good thing!</strong> was published on <time datetime="2007-12-29T23:31:34+01:00">December 29, 2007</time>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/posts/">View all posts</a>)</small></h4>
    <ul>
    
      <li><a href="/blog/update/new-blog/" title="Moving the Blog to github pages">Moving the Blog to github pages</a></li>
    
      <li><a href="/uncategorized/nifty-1-4-has-been-released/" title="Nifty 1.4 has been released">Nifty 1.4 has been released</a></li>
    
      <li><a href="/uncategorized/jogamp-bof-siggraph-2013/" title="JogAmp BOF Siggraph 2013">JogAmp BOF Siggraph 2013</a></li>
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    

<span>&copy; 2014 void256. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/minimal-mistakes/" rel="nofollow">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>


  
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'nifty-gui'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

	        

</body>
</html>